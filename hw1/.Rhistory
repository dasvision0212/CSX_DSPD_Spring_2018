geom_line(mapping =  aes(x = time, y = CTV, group = 1, size = "4"),color = "#00FF66") +
geom_line(mapping =  aes(x = time, y = EHS, group = 1, size = "4"),color = "#66FFFF") +
geom_line(mapping =  aes(x = t, y = CEC$Ding, group = 1, size = "4"), color = "#CC0000") +
geom_line(mapping =  aes(x = t, y = PTS$Ding, group = 1, size = "4"), color ="#999999")+
labs(x = "time ", y = "numbers of votes",
title = "Votes for Ding (CEC)", caption = "(data from CEC with ideal model)") +
scale_x_discrete(breaks = seq(0, 129, by = 5)) +
scale_y_continuous(labels= scales::comma)
ggplot(data = media_Ko) +
geom_point(mapping =  aes(x = t, y = media_Ko$TTV),color = "#3333CC") +
geom_point(mapping =  aes(x = t, y = media_Ko$SET),color = "#0099CC") +
geom_point(mapping =  aes(x = t, y = media_Ko$CTV),color = "#00FF66") +
geom_point(mapping =  aes(x = t, y = media_Ko$EHS),color = "#66FFFF") +
geom_line(mapping =  aes(x = t, y = CEC$Ko, group = 1, size = "4"), color = "#CC0000") +
geom_line(mapping =  aes(x = t, y = PTS$Ko, group = 1, size = "4"), color = "#999999") +
labs(x = "time ", y = "numbers of votes",
title = "Votes for Ko (CEC)", caption = "(data from media)") +
scale_x_discrete(breaks = seq(0, 129, by = 5)) +
scale_y_continuous(labels= scales::comma)
ggplot(data = media_Ko) +
geom_point(mapping =  aes(x = t, y = media_Ko$TTV),color = "#3333CC") +
geom_point(mapping =  aes(x = t, y = media_Ko$SET),color = "#0099CC") +
geom_point(mapping =  aes(x = t, y = media_Ko$CTV),color = "#00FF66") +
geom_point(mapping =  aes(x = t, y = media_Ko$EHS),color = "#66FFFF") +
geom_line(mapping =  aes(x = t, y = CEC$Ke, group = 1, size = "4"), color = "#CC0000") +
geom_line(mapping =  aes(x = t, y = PTS$Ko, group = 1, size = "4"), color = "#999999") +
labs(x = "time ", y = "numbers of votes",
title = "Votes for Ko (CEC)", caption = "(data from media)") +
scale_x_discrete(breaks = seq(0, 129, by = 5)) +
scale_y_continuous(labels= scales::comma)
ggplot(data = media_Ko) +
geom_line(mapping =  aes(x = time, y = TTV, group = 1, size = "4"),color = "#3333CC") +
geom_line(mapping =  aes(x = time, y = SET, group = 1, size = "4"),color = "#0099CC") +
geom_line(mapping =  aes(x = time, y = CTV, group = 1, size = "4"),color = "#00FF66") +
geom_line(mapping =  aes(x = time, y = EHS, group = 1, size = "4"),color = "#66FFFF") +
geom_line(mapping =  aes(x = t, y = CEC$Ke, group = 1, size = "4"), color = "#CC0000") +
geom_line(mapping =  aes(x = t, y = PTS$Ko, group = 1, size = "4"), color = "#999999") +
labs(x = "time ", y = "numbers of votes",
title = "Votes for Ko (CEC)", caption = "(data from media)") +
scale_x_discrete(breaks = seq(0, 129, by = 5)) +
scale_y_continuous(labels= scales::comma)
media <- read.csv("data/media_vote.csv")
media_Ding <- data.frame(TTV = media$TTV_1, SET = media$SET_1, CTV = media$SET_1, EHS = media$EHS_1)
media_Ko   <- data.frame(TTV = media$TTV_2, SET = media$SET_2, CTV = media$SET_2, EHS = media$EHS_2)
###vote for Ding, Shou-chung and Ko Wen-je
ggplot(data = media_Ding) +
geom_line(mapping =  aes(x = time, y = TTV, group = 1, size = "4"),color = "#3333CC") +
geom_line(mapping =  aes(x = time, y = SET, group = 1, size = "4"),color = "#0099CC") +
geom_line(mapping =  aes(x = time, y = CTV, group = 1, size = "4"),color = "#00FF66") +
geom_line(mapping =  aes(x = time, y = EHS, group = 1, size = "4"),color = "#66FFFF") +
labs(x = "time ", y = "numbers of votes",
title = "Votes for Ding (CEC)", caption = "(data from CEC with assumed model)") +
scale_x_discrete(breaks = seq(0, 129, by = 5)) +
scale_y_continuous(labels= scales::comma)
ggplot(data = media_Ding) +
geom_line(mapping =  aes(x = time, y = TTV, group = 1, size = "4"),color = "#3333CC") +
geom_line(mapping =  aes(x = time, y = SET, group = 1, size = "4"),color = "#0099CC") +
geom_line(mapping =  aes(x = time, y = CTV, group = 1, size = "4"),color = "#00FF66") +
geom_line(mapping =  aes(x = time, y = EHS, group = 1, size = "4"),color = "#66FFFF") +
geom_line(mapping =  aes(x = time, y = PTS$Ding, group =1, size = "4"), color="#CC0000")+
labs(x = "time ", y = "numbers of votes", title = "Votes for Ding (CEC)", caption = "(data from media)") +
scale_x_discrete(breaks = seq(0, 129, by = 5)) +
scale_y_continuous(labels= scales::comma)
ggplot(data = media_Ko) +
geom_line(mapping =  aes(x = time, y = TTV, group = 1, size = "4"),color = "#3333CC") +
geom_line(mapping =  aes(x = time, y = SET, group = 1, size = "4"),color = "#0099CC") +
geom_line(mapping =  aes(x = time, y = CTV, group = 1, size = "4"),color = "#00FF66") +
geom_line(mapping =  aes(x = time, y = EHS, group = 1, size = "4"),color = "#66FFFF") +
geom_line(mapping =  aes(x = t, y = PTS$Ko,group = 1, size = "4"), color="#CC0000")+
labs(x = "time ", y = "numbers of votes",
title = "Votes for Ko (CEC)", caption = "(data from media)") +
scale_x_discrete(breaks = seq(0, 129, by = 5)) +
scale_y_continuous(labels= scales::comma)
ggplot(data = media_Ding) +
geom_line(mapping =  aes(x = time, y = TTV, group = 1, size = "4"),color = "#3333CC") +
geom_line(mapping =  aes(x = time, y = SET, group = 1, size = "4"),color = "#0099CC") +
geom_line(mapping =  aes(x = time, y = CTV, group = 1, size = "4"),color = "#00FF66") +
geom_line(mapping =  aes(x = time, y = EHS, group = 1, size = "4"),color = "#66FFFF") +
geom_line(mapping =  aes(x = t, y = CEC$Ding, group = 1, size = "4"), color = "#CC0000") +
geom_line(mapping =  aes(x = t, y = PTS$Ding, group = 1, size = "4"), color = "#999999") +
labs(x = "time ", y = "numbers of votes",
title = "Votes for Ding (CEC)", caption = "(data from CEC with ideal model)") +
scale_x_discrete(breaks = seq(0, 129, by = 5)) +
scale_y_continuous(labels= scales::comma)
ggplot(data = media_Ko) +
geom_line(mapping =  aes(x = time, y = TTV, group = 1, size = "4"),color = "#3333CC") +
geom_line(mapping =  aes(x = time, y = SET, group = 1, size = "4"),color = "#0099CC") +
geom_line(mapping =  aes(x = time, y = CTV, group = 1, size = "4"),color = "#00FF66") +
geom_line(mapping =  aes(x = time, y = EHS, group = 1, size = "4"),color = "#66FFFF") +
geom_line(mapping =  aes(x = t, y = CEC$Ke, group = 1, size = "4"), color = "#CC0000") +
geom_line(mapping =  aes(x = t, y = PTS$Ko, group = 1, size = "4"), color = "#999999") +
labs(x = "time ", y = "numbers of votes",
title = "Votes for Ko (CEC)", caption = "(data from media)") +
scale_x_discrete(breaks = seq(0, 129, by = 5)) +
scale_y_continuous(labels= scales::comma)
#PTS data
PTS <- read.csv("data/PTS_vote.csv")
##time line in 24-hour based
time = factor(PTS$time, levels= PTS$time)
PTS <- data.frame(time = time, Ding = PTS$PTS_1, Ko = PTS$PTS_2)
ggplot(data = PTS) +
geom_line(mapping =  aes(x = time, y = Ding, group = 1)) +
labs(x = "time ", y = "numbers of votes",
title = "Votes for Ding (PTS)", caption = "(data from PTS live-stream)") +
scale_y_continuous(labels= scales::comma)
#PTS data
PTS <- read.csv("data/PTS_vote.csv")
##time line in 24-hour based
time = factor(PTS$time, levels= PTS$time)
PTS <- data.frame(time = time, Ding = PTS$PTS_1, Ko = PTS$PTS_2)
ggplot(data = PTS) +
geom_line(mapping =  aes(x = time, y = Ding, group = 1)) +
labs(x = "time ", y = "numbers of votes",
title = "Votes for Ding (PTS)", caption = "(data from PTS live-stream)") +
scale_x_discrete(breaks = seq(0, 129, by = 5)) +
scale_y_continuous(labels= scales::comma)
#PTS data
PTS <- read.csv("data/PTS_vote.csv")
##time line in 24-hour based
time = factor(PTS$time, levels= PTS$time)
PTS <- data.frame(time = time, Ding = PTS$PTS_1, Ko = PTS$PTS_2)
ggplot(data = PTS) +
geom_line(mapping =  aes(x = time, y = Ding, group = 1)) +
labs(x = "time ", y = "numbers of votes",
title = "Votes for Ding (PTS)", caption = "(data from PTS live-stream)") +
scale_y_continuous(labels= scales::comma)
#PTS data
PTS <- read.csv("data/PTS_vote.csv")
##time line in 24-hour based
time = factor(PTS$time, levels= PTS$time)
PTS <- data.frame(time = time, Ding = PTS$PTS_1, Ko = PTS$PTS_2)
ggplot(data = PTS) +
geom_line(mapping =  aes(x = time, y = Ding, group = 1)) +
labs(x = "time ", y = "numbers of votes",
title = "Votes for Ding (PTS)", caption = "(data from PTS live-stream)") +
scale_x_discrete(breaks = seq(0, 129, by = 5)) +
scale_y_continuous(labels= scales::comma)
#PTS data
PTS <- read.csv("data/PTS_vote.csv")
##time line in 24-hour based
time = factor(PTS$time, levels= PTS$time)
PTS <- data.frame(time = time, Ding = PTS$PTS_1, Ko = PTS$PTS_2)
ggplot(data = PTS) +
geom_line(mapping =  aes(x = reorder(PTS$time, c(1:129)), y = Ding, group = 1)) +
labs(x = "time ", y = "numbers of votes",
title = "Votes for Ding (PTS)", caption = "(data from PTS live-stream)") +
scale_x_discrete(breaks = seq(0, 129, by = 5)) +
scale_y_continuous(labels= scales::comma)
#PTS data
PTS <- read.csv("data/PTS_vote.csv")
##time line in 24-hour based
time = factor(PTS$time, levels= PTS$time)
PTS <- data.frame(time = time, Ding = PTS$PTS_1, Ko = PTS$PTS_2)
ggplot(data = PTS) +
geom_line(mapping =  aes(x = reorder(PTS$time, c(1:129)), y = Ding, group = 1)) +
labs(x = "time ", y = "numbers of votes",
title = "Votes for Ding (PTS)", caption = "(data from PTS live-stream)") +
scale_y_continuous(labels= scales::comma)
#PTS data
PTS <- read.csv("data/PTS_vote.csv")
##time line in 24-hour based
time = factor(PTS$time, levels= PTS$time)
PTS <- data.frame(time = time, Ding = PTS$PTS_1, Ko = PTS$PTS_2)
ggplot(data = PTS) +
geom_line(mapping =  aes(x = reorder(PTS$time, c(1:129)), y = Ding, group = 1)) +
labs(x = "time ", y = "numbers of votes",
title = "Votes for Ding (PTS)", caption = "(data from PTS live-stream)") +
scale_x_continuous(breaks = seq(1,129,by=5))+
scale_y_continuous(labels= scales::comma)
#PTS data
PTS <- read.csv("data/PTS_vote.csv")
##time line in 24-hour based
time = factor(PTS$time, levels= PTS$time)
PTS <- data.frame(time = time, Ding = PTS$PTS_1, Ko = PTS$PTS_2)
ggplot(data = PTS) +
geom_line(mapping =  aes(x = reorder(PTS$time, c(1:129), y = Ding, group = 1)) +
labs(x = "time ", y = "numbers of votes",
title = "Votes for Ding (PTS)", caption = "(data from PTS live-stream)") +
scale_x_discrete(breaks = seq(0, 129, by = 5)) +
scale_y_continuous(labels= scales::comma)
#PTS data
PTS <- read.csv("data/PTS_vote.csv")
##time line in 24-hour based
time = factor(PTS$time, levels= PTS$time)
PTS <- data.frame(time = time, Ding = PTS$PTS_1, Ko = PTS$PTS_2)
ggplot(data = PTS) +
geom_line(mapping =  aes(x = reorder(PTS$time, c(1:129), y = Ding, group = 1)) +
labs(x = "time ", y = "numbers of votes",
title = "Votes for Ding (PTS)", caption = "(data from PTS live-stream)") +
scale_x_discrete(breaks = seq(0, 129, by = 5)) +
scale_y_continuous(labels= scales::comma))
#PTS data
PTS <- read.csv("data/PTS_vote.csv")
##time line in 24-hour based
time = factor(PTS$time, levels= PTS$time)
PTS <- data.frame(time = time, Ding = PTS$PTS_1, Ko = PTS$PTS_2)
ggplot(data = PTS) +
geom_line(mapping =  aes(x = reorder(PTS$time, c(1:129)), y = Ding, group = 1)) +
labs(x = "time ", y = "numbers of votes",
title = "Votes for Ding (PTS)", caption = "(data from PTS live-stream)") +
scale_x_discrete(breaks = seq(0, 129, by = 5)) +
scale_y_continuous(labels= scales::comma))
#PTS data
PTS <- read.csv("data/PTS_vote.csv")
##time line in 24-hour based
time = factor(PTS$time, levels= PTS$time)
PTS <- data.frame(time = time, Ding = PTS$PTS_1, Ko = PTS$PTS_2)
ggplot(data = PTS) +
geom_line(mapping =  aes(x = reorder(PTS$time, c(1:129)), y = Ding, group = 1)) +
labs(x = "time ", y = "numbers of votes",
title = "Votes for Ding (PTS)", caption = "(data from PTS live-stream)") +
scale_x_discrete(breaks = seq(0, 129, by = 5)) +
scale_y_continuous(labels= scales::comma)
#PTS data
PTS <- read.csv("data/PTS_vote.csv")
##time line in 24-hour based
time = factor(PTS$time, levels= PTS$time)
PTS <- data.frame(time = time, Ding = PTS$PTS_1, Ko = PTS$PTS_2)
ggplot(data = PTS) +
geom_line(mapping =  aes(x = reorder(PTS$time, c(1:129)), y = Ding, group = 1)) +
labs(x = "time ", y = "numbers of votes",
title = "Votes for Ding (PTS)", caption = "(data from PTS live-stream)") +
scale_x_discrete(breaks = c(1,2,3)) +
scale_y_continuous(labels= scales::comma)
#PTS data
PTS <- read.csv("data/PTS_vote.csv")
##time line in 24-hour based
time = factor(PTS$time, levels= PTS$time)
PTS <- data.frame(time = time, Ding = PTS$PTS_1, Ko = PTS$PTS_2)
ggplot(data = PTS) +
geom_line(mapping =  aes(x = reorder(PTS$time, c(1:129)), y = Ding, group = 1)) +
labs(x = "time ", y = "numbers of votes",
title = "Votes for Ding (PTS)", caption = "(data from PTS live-stream)") +
scale_x_discrete(breaks = seq(1, 129, by = 5)) +
scale_y_continuous(labels= scales::comma)
reorder(PTS$time, c(1:129)
reorder(PTS$time, c(1:129))
#PTS data
PTS <- read.csv("data/PTS_vote.csv")
##time line in 24-hour based
time = factor(PTS$time, levels= PTS$time)
PTS <- data.frame(time = time, Ding = PTS$PTS_1, Ko = PTS$PTS_2)
PTS$time, c(1:129))
#PTS data
PTS <- read.csv("data/PTS_vote.csv")
##time line in 24-hour based
time = factor(PTS$time, levels= PTS$time)
PTS <- data.frame(time = time, Ding = PTS$PTS_1, Ko = PTS$PTS_2)
ggplot(data = PTS) +
geom_line(mapping =  aes(x = reorder(PTS$time, c(1:129)), y = Ding, group = 1)) +
labs(x = "time ", y = "numbers of votes",
title = "Votes for Ding (PTS)", caption = "(data from PTS live-stream)") +
scale_x_discrete(breaks = PTS$time[seq(1, 129, by = 5)]) +
scale_y_continuous(labels= scales::comma)
#PTS data
PTS <- read.csv("data/PTS_vote.csv")
##time line in 24-hour based
time = factor(PTS$time, levels= PTS$time)
PTS <- data.frame(time = time, Ding = PTS$PTS_1, Ko = PTS$PTS_2)
ggplot(data = PTS) +
geom_line(mapping =  aes(x = reorder(PTS$time, c(1:129)), y = Ding, group = 1)) +
labs(x = "time ", y = "numbers of votes",
title = "Votes for Ding (PTS)", caption = "(data from PTS live-stream)") +
scale_x_discrete(breaks = PTS$time[seq(1, 129, by = 10)]) +
scale_y_continuous(labels= scales::comma)
#PTS data
PTS <- read.csv("data/PTS_vote.csv")
##time line in 24-hour based
time = factor(PTS$time, levels= PTS$time)
reorder(PTS$time, c(1:129))
PTS <- data.frame(time = time, Ding = PTS$PTS_1, Ko = PTS$PTS_2)
ggplot(data = PTS) +
geom_line(mapping =  aes(x = reorder(PTS$time, c(1:129)), y = Ding, group = 1)) +
labs(x = "time ", y = "numbers of votes",
title = "Votes for Ding (PTS)", caption = "(data from PTS live-stream)") +
scale_x_discrete(breaks = PTS$time[seq(1, 129, by = 10)]) +
scale_y_continuous(labels= scales::comma)
##time line in 24-hour based
time = reorder(PTS$time, c(1:129))
#PTS data
PTS <- read.csv("data/PTS_vote.csv")
##time line in 24-hour based
time = reorder(PTS$time, c(1:129))
PTS <- data.frame(time = time, Ding = PTS$PTS_1, Ko = PTS$PTS_2)
ggplot(data = PTS) +
geom_line(mapping =  aes(x = time, y = Ding, group = 1)) +
labs(x = "time ", y = "numbers of votes",
title = "Votes for Ding (PTS)", caption = "(data from PTS live-stream)") +
scale_x_discrete(breaks = PTS$time[seq(1, 129, by = 10)]) +
scale_y_continuous(labels= scales::comma)
## plot the number of votes based on time
ggplot(data = CEC) +
geom_line(mapping =  aes(x = t, y = Ding, group = 1)) +
labs(x = "time ", y = "numbers of votes",
title = "Votes for Ding (CEC)", caption = "(data from CEC with assumed model)") +
scale_x_discrete(breaks = PTS$time[seq(1, 129, by = 10)]) +
scale_y_continuous(labels= scales::comma)
##library for later graphing
install.packages("tidyverse")
library(tidyverse)
#PTS data
PTS <- read.csv("data/PTS_vote.csv")
##time line in 24-hour based
time = reorder(PTS$time, c(1:129))
PTS <- data.frame(time = time, Ding = PTS$PTS_1, Ko = PTS$PTS_2)
ggplot(data = PTS) +
geom_line(mapping =  aes(x = time, y = Ding, group = 1)) +
labs(x = "time ", y = "numbers of votes",
title = "Votes for Ding (PTS)", caption = "(data from PTS live-stream)") +
scale_x_discrete(breaks = PTS$time[seq(1, 129, by = 10)]) +
scale_y_continuous(labels= scales::comma)
CEC_endtime <- read.csv("data/CEC_time.csv", as.is=TRUE)
CEC_endtime <- CEC_endtime[CEC_endtime$X == "taipei",]
CEC_endtime
CEC_vote <- read.csv("data/CEC_vote.csv")
CEC_vote
##convert the 24-based into how many 5 minutes after 16:00
standardlize_unit <- function(t){
hour <- as.integer(substr(t,1,2))
min  <- as.integer(substr(t,4,5))
for(i in 1:length(hour)){
if(hour[i] < 8){
hour[i] = hour[i]+24
}
}
##official procedure starts from 17:00
hour = hour-17
return ((60*hour+min)/5)
}
##the end time fro each observation post
end_time <- standardlize_unit(CEC_endtime$time)
head(end_time)
##the rate for each observation post
rate <- CEC_vote[,c(2,4)]/end_time
rate
sum_model <- function(r, t){
total <- vector(mode = "numeric", length = 116) ##17:00~02:40
length(total)
#time
for(i in 1:117){
#station
for(j in 1:length(r)){
if(t[j] > i){
total[i] = total[i] + i*r[j]
} else if(t[j] < i) {
total[i] = total[i] + t[j]*r[j]
}
if(floor(t[j]) == i) {
total[i] = total[i] +  (t[j]-i)*r[j]
}
}
}
return (total)
}
window12 <- vector(mode = "double", length = 12)
CEC <- data.frame(Ding  = c(window12, sum_model(rate$ding , end_time)), Ke = c(window12,sum_model(rate$ke, end_time)))
head(CEC)
## plot the number of votes based on time
ggplot(data = CEC) +
geom_line(mapping =  aes(x = t, y = Ding, group = 1)) +
labs(x = "time ", y = "numbers of votes",
title = "Votes for Ding (CEC)", caption = "(data from CEC with assumed model)") +
scale_x_discrete(breaks = PTS$time[seq(1, 129, by = 10)]) +
scale_y_continuous(labels= scales::comma)
media <- read.csv("data/media_vote.csv")
media_Ding <- data.frame(TTV = media$TTV_1, SET = media$SET_1, CTV = media$SET_1, EHS = media$EHS_1)
media_Ko   <- data.frame(TTV = media$TTV_2, SET = media$SET_2, CTV = media$SET_2, EHS = media$EHS_2)
###vote for Ding, Shou-chung and Ko Wen-je
ggplot(data = media_Ding) +
geom_line(mapping =  aes(x = time, y = TTV, group = 1, size = "4"),color = "#3333CC") +
geom_line(mapping =  aes(x = time, y = SET, group = 1, size = "4"),color = "#0099CC") +
geom_line(mapping =  aes(x = time, y = CTV, group = 1, size = "4"),color = "#00FF66") +
geom_line(mapping =  aes(x = time, y = EHS, group = 1, size = "4"),color = "#66FFFF") +
labs(x = "time ", y = "numbers of votes",
title = "Votes for Ding (CEC)", caption = "(data from CEC with assumed model)") +
scale_x_discrete(breaks = PTS$time[seq(1, 129, by = 10)]) +
scale_y_continuous(labels= scales::comma)
ggplot(data = media_Ding) +
geom_line(mapping =  aes(x = time, y = TTV, group = 1, size = "4"),color = "#3333CC") +
geom_line(mapping =  aes(x = time, y = SET, group = 1, size = "4"),color = "#0099CC") +
geom_line(mapping =  aes(x = time, y = CTV, group = 1, size = "4"),color = "#00FF66") +
geom_line(mapping =  aes(x = time, y = EHS, group = 1, size = "4"),color = "#66FFFF") +
geom_line(mapping =  aes(x = time, y = PTS$Ding, group =1, size = "4"), color="#CC0000")+
labs(x = "time ", y = "numbers of votes", title = "Votes for Ding (CEC)", caption = "(data from media)") +
scale_x_discrete(breaks = PTS$time[seq(1, 129, by = 10)]) +
scale_y_continuous(labels= scales::comma)
ggplot(data = media_Ko) +
geom_line(mapping =  aes(x = time, y = TTV, group = 1, size = "4"),color = "#3333CC") +
geom_line(mapping =  aes(x = time, y = SET, group = 1, size = "4"),color = "#0099CC") +
geom_line(mapping =  aes(x = time, y = CTV, group = 1, size = "4"),color = "#00FF66") +
geom_line(mapping =  aes(x = time, y = EHS, group = 1, size = "4"),color = "#66FFFF") +
geom_line(mapping =  aes(x = t, y = PTS$Ko,group = 1, size = "4"), color="#CC0000")+
labs(x = "time ", y = "numbers of votes",
title = "Votes for Ko (CEC)", caption = "(data from media)") +
scale_x_discrete(breaks = PTS$time[seq(1, 129, by = 10)]) +
scale_y_continuous(labels= scales::comma)
ggplot(data = media_Ding) +
geom_line(mapping =  aes(x = time, y = TTV, group = 1, size = "4"),color = "#3333CC") +
geom_line(mapping =  aes(x = time, y = SET, group = 1, size = "4"),color = "#0099CC") +
geom_line(mapping =  aes(x = time, y = CTV, group = 1, size = "4"),color = "#00FF66") +
geom_line(mapping =  aes(x = time, y = EHS, group = 1, size = "4"),color = "#66FFFF") +
geom_line(mapping =  aes(x = t, y = CEC$Ding, group = 1, size = "4"), color = "#CC0000") +
geom_line(mapping =  aes(x = t, y = PTS$Ding, group = 1, size = "4"), color = "#999999") +
labs(x = "time ", y = "numbers of votes",
title = "Votes for Ding (CEC)", caption = "(data from CEC with ideal model)") +
scale_x_discrete(breaks = PTS$time[seq(1, 129, by = 10)]) +
scale_y_continuous(labels= scales::comma)
ggplot(data = media_Ko) +
geom_line(mapping =  aes(x = time, y = TTV, group = 1, size = "4"),color = "#3333CC") +
geom_line(mapping =  aes(x = time, y = SET, group = 1, size = "4"),color = "#0099CC") +
geom_line(mapping =  aes(x = time, y = CTV, group = 1, size = "4"),color = "#00FF66") +
geom_line(mapping =  aes(x = time, y = EHS, group = 1, size = "4"),color = "#66FFFF") +
geom_line(mapping =  aes(x = t, y = CEC$Ke, group = 1, size = "4"), color = "#CC0000") +
geom_line(mapping =  aes(x = t, y = PTS$Ko, group = 1, size = "4"), color = "#999999") +
labs(x = "time ", y = "numbers of votes",
title = "Votes for Ko (CEC)", caption = "(data from media)") +
scale_x_discrete(breaks = PTS$time[seq(1, 129, by = 10)]) +
scale_y_continuous(labels= scales::comma)
install.packages("tidyverse")
## plot the number of votes based on time
ggplot(data = CEC) +
geom_line(mapping =  aes(x = t, y = Ding, group = 1)) +
labs(x = "time ", y = "numbers of votes",
title = "Votes for Ding (CEC)", caption = "(data from CEC with assumed model)") +
scale_x_discrete(breaks = PTS$time[seq(1, 129, by = 10)]) +
scale_y_continuous(labels= scales::comma)
#PTS data
PTS <- read.csv("data/PTS_vote.csv")
##time line in 24-hour based
time = reorder(PTS$time, c(1:129))
PTS <- data.frame(time = time, Ding = PTS$PTS_1, Ko = PTS$PTS_2)
ggplot(data = PTS) +
geom_line(mapping =  aes(x = time, y = Ding, group = 1)) +
labs(x = "time ", y = "numbers of votes",
title = "Votes for Ding (PTS)", caption = "(data from PTS live-stream)") +
scale_x_discrete(breaks = PTS$time[seq(1, 129, by = 10)]) +
scale_y_continuous(labels= scales::comma)
library(tidyverse)
#PTS data
PTS <- read.csv("data/PTS_vote.csv")
##time line in 24-hour based
time = reorder(PTS$time, c(1:129))
PTS <- data.frame(time = time, Ding = PTS$PTS_1, Ko = PTS$PTS_2)
ggplot(data = PTS) +
geom_line(mapping =  aes(x = time, y = Ding, group = 1)) +
labs(x = "time ", y = "numbers of votes",
title = "Votes for Ding (PTS)", caption = "(data from PTS live-stream)") +
scale_x_discrete(breaks = PTS$time[seq(1, 129, by = 10)]) +
scale_y_continuous(labels= scales::comma)
## plot the number of votes based on time
ggplot(data = CEC) +
geom_line(mapping =  aes(x = t, y = Ding, group = 1)) +
labs(x = "time ", y = "numbers of votes",
title = "Votes for Ding (CEC)", caption = "(data from CEC with assumed model)") +
scale_x_discrete(breaks = PTS$time[seq(1, 129, by = 10)]) +
scale_y_continuous(labels= scales::comma)
sum_model <- function(r, t){
total <- vector(mode = "numeric", length = 116) ##17:00~02:40
length(total)
#time
for(i in 1:117){
#station
for(j in 1:length(r)){
if(t[j] > i){
total[i] = total[i] + i*r[j]
} else if(t[j] < i) {
total[i] = total[i] + t[j]*r[j]
}
if(floor(t[j]) == i) {
total[i] = total[i] +  (t[j]-i)*r[j]
}
}
}
return (total)
}
window12 <- vector(mode = "double", length = 12)
CEC <- data.frame(Ding  = c(window12, sum_model(rate$ding , end_time)), Ke = c(window12,sum_model(rate$ke, end_time)))
media <- read.csv("data/media_vote.csv")
media_Ding <- data.frame(TTV = media$TTV_1, SET = media$SET_1, CTV = media$SET_1, EHS = media$EHS_1)
media_Ko   <- data.frame(TTV = media$TTV_2, SET = media$SET_2, CTV = media$SET_2, EHS = media$EHS_2)
###vote for Ding, Shou-chung and Ko Wen-je
ggplot(data = media_Ding) +
geom_line(mapping =  aes(x = time, y = TTV, group = 1, size = "4"),color = "#3333CC") +
geom_line(mapping =  aes(x = time, y = SET, group = 1, size = "4"),color = "#0099CC") +
geom_line(mapping =  aes(x = time, y = CTV, group = 1, size = "4"),color = "#00FF66") +
geom_line(mapping =  aes(x = time, y = EHS, group = 1, size = "4"),color = "#66FFFF") +
labs(x = "time ", y = "numbers of votes",
title = "Votes for Ding (CEC)", caption = "(data from CEC with assumed model)") +
scale_x_discrete(breaks = PTS$time[seq(1, 129, by = 10)]) +
scale_y_continuous(labels= scales::comma)
ggplot(data = media_Ding) +
geom_line(mapping =  aes(x = time, y = TTV, group = 1, size = "4"),color = "#3333CC") +
geom_line(mapping =  aes(x = time, y = SET, group = 1, size = "4"),color = "#0099CC") +
geom_line(mapping =  aes(x = time, y = CTV, group = 1, size = "4"),color = "#00FF66") +
geom_line(mapping =  aes(x = time, y = EHS, group = 1, size = "4",color = "#66FFFF")) +
geom_line(mapping =  aes(x = t, y = CEC$Ding, group = 1, size = "4"), color = "#CC0000") +
geom_line(mapping =  aes(x = t, y = PTS$Ding, group = 1, size = "4"), color = "#999999") +
labs(x = "time ", y = "numbers of votes",
title = "Votes for Ding (CEC)", caption = "(data from CEC with ideal model)") +
scale_x_discrete(breaks = PTS$time[seq(1, 129, by = 10)]) +
scale_y_continuous(labels= scales::comma)
ggplot(data = media_Ding) +
geom_line(mapping =  aes(x = time, y = TTV, group = 1, size = "4"),color = "#3333CC") +
geom_line(mapping =  aes(x = time, y = SET, group = 1, size = "4"),color = "#0099CC") +
geom_line(mapping =  aes(x = time, y = CTV, group = 1, size = "4"),color = "#00FF66") +
geom_line(mapping =  aes(x = time, y = EHS, group = 1, size = "4"),color = "#66FFFF") +
geom_line(mapping =  aes(x = t, y = CEC$Ding, group = 1, size = "4"), color = "#CC0000") +
geom_line(mapping =  aes(x = t, y = PTS$Ding, group = 1, size = "4"), color = "#999999") +
labs(x = "time ", y = "numbers of votes",
title = "Votes for Ding (CEC)", caption = "(data from CEC with ideal model)") +
scale_x_discrete(breaks = PTS$time[seq(1, 129, by = 10)]) +
scale_y_continuous(labels= scales::comma)
